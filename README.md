Restrict actions for users controller

- Added `require_same_user` method to users controller.

- Used `require_same_user` and `require_user` methods to restrict certain actions in the users controller.
